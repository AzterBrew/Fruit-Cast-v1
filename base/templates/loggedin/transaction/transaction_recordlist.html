{% comment %} {% extends "loggedin/layout.html" %} {% endcomment %}

{% block title %}
{% comment %} Fruit Cast | Harvest Record Transaction {% endcomment %}
{% endblock title %}

{% block content %}
<div class="container">
    <div class="record-cart">
        <h2>Current Transaction</h4>
        <p class="mb-4">Note : Proceeding with Record does not mean the record has been saved in the database. Proceed with Record and Complete the Transaction to successfully submit the record</p>
        {% if pending_records %}
            <table class="table table-sm table-bordered">
                <thead>
                    <tr>
                        {% if record_type == "harvest" %}
                            <th>Date</th>
                            <th>Commodity</th>
                            <th>Spec</th>
                            <th>Weight</th>
                            <th>Unit</th>
                            <th>Location</th>
                            <th>Remarks</th>
                        {% else %}
                            <th>Plant Date</th>
                            <th>Commodity Type</th>
                            <th>Commodity Specification</th>
                            <th>Expected Harvest Date</th>
                            <th>Plant Location (by hectare)</th>
                            <th>Minimum Expected Harvest</th>
                            <th>Maximum Expected Harvest</th>
                            <th>Land Area</th>
                            <th>Remarks</th>
                        {% endif %}
                        <th>
                            Edit
                        </th>
                        <th>
                            Remove
                        </th>
                    </tr>
                </thead>
                <tbody>
                    {% for record in pending_records %}
                    <tr>
                        {% if record_type == "harvest" %}
                            <td>{{ record.harvest_date }}</td>
                            <td>{{ record.commodity_type }}</td>
                            <td>{{ record.commodity_spec }}</td>
                            <td>{{ record.total_weight }}</td>
                            <td>{{ record.unit }}</td>
                            <td>{{ record.harvest_location }}</td>
                            <td>{{ record.remarks }}</td>
                            <td>
                            {% comment %} <a href="{% url 'base:edit_pending_record' forloop.counter0 %}?view=harvest&from=transactionedit" class="btn btn-success btn-sm">Edit</a> {% endcomment %}
                            <a href="{% url 'base:edit_pending_record' forloop.counter0 %}?record_type={{ record_type }}&from=transactionedit" class="btn btn-warning">Edit</a>
                            </td>
                            <td>
                            <form method="POST" action="{% url 'base:remove_pending_record' forloop.counter0 %}">
                                {% csrf_token %}
                                <input type="hidden" name="record_type" value="{{ record_type }}">
                                <button type="submit" class="btn btn-danger btn-sm">Remove</button>
                            </form>
                            </td>
                        {% else %}
                            <td>{{ record.plant_date }}</td>
                            <td>{{ record.commodity_type }}</td>
                            <td>{{ record.commodity_spec }}</td>
                            <td>{{ record.expected_harvest_date }}</td>
                            <td>{{ record.plant_location }}</td>
                            <td>{{ record.min_expected_harvest }}</td>
                            <td>{{ record.max_expected_harvest }}</td>
                            <td>{{ record.land_area }}</td>
                            <td>{{ record.remarks }}</td>
                            <td>
                            {% comment %} <a href="{% url 'base:edit_pending_record' forloop.counter0 %}?view=harvest&from=transactionedit" class="btn btn-success btn-sm">Edit</a> {% endcomment %}
                            <a href="{% url 'base:edit_pending_record' forloop.counter0 %}?record_type={{ record_type }}&from=transactionedit" class="btn btn-warning">Edit</a>
                            </td>
                            <td>
                            <form method="POST" action="{% url 'base:remove_pending_record' forloop.counter0 %}">
                                {% csrf_token %}
                                <input type="hidden" name="record_type" value="{{ record_type }}">
                                <button type="submit" class="btn btn-danger btn-sm">Remove</button>
                            </form>
                            </td>
                        {% endif %}

                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <a href="{% url 'base:newrecord' %}?view=harvest&from=transaction" class="btn btn-warning btn-sm">Add Record</a>
            {% comment %} yung '&from' indicates na tracked na galing transaction page {% endcomment %}
            <br>
            <br>
            <form method="POST" action="{% url 'base:finalize_transaction' %}">
                {% csrf_token %}
                {% comment %} ADD NOTES {% endcomment %}
                <input type="hidden" name="record_type" value="{{ record_type }}">
                <button type="submit" class="btn btn-success btn-sm">Submit All Records</button>
            </form>
        {% else %}
            <p>No records yet.</p>
        {% endif %}
    </div>
    
</div>
{% endblock content %}
